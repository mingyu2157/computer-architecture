# Chapter05 CPU 성능 향상 기법

## 빠른 CPU를 위한 설계 기법

### 클럭

- 클럭 속도가 넢아지면 CPU는 명령어 사이클을 더 빠르게 반복 -> 클럭 속도가 높은 CPU는 일반적으로 성능이 굿
- 클럭 속도 : 헤르츠(Hz) 단위로 측정 (클럭 속도는 일정하지 않음)
- 클럭 속도만으로 CPU의 성능을 올리는 것에는 한계가 있음 -> 대표적인 해결책 : 코어와 스레드 수를 늘리는 방법

### 코어와 멀티코어

- 코어 : 지금까지 CPU의 정의로 알고있었던 명령어를 실행하는 부품
- 멀티코어 : 코어를 여러 개 포함하고 있는 CPU (멀티코어CPU 또는 멀티코어 프로세서 라고 부름)
- CPU의 연산 속도는 꼭 코어 수에 비례하여 증가하지는 않음

### 스레드와 멀티스레드

- 스레드 : 사전적 의미 '실행 흐름의 단위'(?)

  1.    CPU에서 사용         -> 하드웨어적 스레드
  2.    프로그램에서 사용    -> 소프트웨어적 스레드

- 스레드의 하드웨어적 정의 : '하나의 코어가 동시에 처리하는 명령어 단위'

  <img src = "https://github.com/mingyu2157/computer-architecture/blob/main/%EC%BD%94%EC%96%B4%20%EC%8A%A4%EB%A0%88%EB%93%9C.jpg?raw=true">

​				8코어 16스레드 그림처럼 하나의 코어로 여러 명령어를 동시에 처리하는 CPU : 멀티스레드 프로세서(또는 CPU)

- 스레드의 소프트웨어적 정의 : '하나의 프로그램에서 독립적으로 실행되는 단위' (?)

  싱글 스레드 : 하나의 프로그램이 실행되는 과정에서 한 부분만 실행

  멀티 스레드 : 프로그램의 여러 부분이 동시에 실행

   

  메모리 입장에서는 2코어 4스레드라도, 마치 4개의 단일 프로세서가 동시에 실행되는 것처럼 보이기 때문에 하드웨어 스레드를 논리 프로세서(logical processor)라고 부르기도 한다

  

## 명령어 병렬 처리 기법 : 명령어를 동시에 처리하여 CPU를 한시도 쉬지 않고 작동시키는 기법

- 명령어가 처리되는 과정
  1. 명령어 인출
  2. 명령어 해석
  3. 명령어 실행
  4. 결과 저장

- 대표적인 명령어 병렬 처리 기법

  1. 명령어 파이프 라이닝
  2. 슈퍼스칼라
  3. 비순차적 명령어 처리

- 명령어 파이프라이닝

  명령어들을 명령어 파이프라인에 넣고 동시에 여러 개의 명령어를 겹쳐 실행하는 기법 (같은 단계가 겹치지 않음)

  but 성능향상에 실패하는 경우 있음 -> 파이프라인 위험

  1. 데이터 위험

     데이터 의존성에 의해 발생  (현재 명령어의 계산결과를 다음 명령어에서 참조할 경우)

  2. 제어 위험

     분기 등으로 인한 프로그램 카운터의 갑작스러운 변화에 의해 발생 ->분기 예측 사용

  3. 구조적 위험

     서로 다른 명령어가 동시에 ALU, 레지스터 등과 같은 CPU 부품을 사용하려고 할때 발생(=자원 위험)

- 슈퍼스칼라

  CPU 내부에 여러 개의 명령어 파이프라인을 포함한 구조

  하나의 파이프라인을 사용할 때보다 파이프라인 위험을 피하기 더 까다로움

- 비순차적 명령어 처리(OoOE)

  데이터 의존성이 없는 명령어를 먼저 실행하여 파이프라인이 멈추는 것을 방지하는 기법

## CISC와 RISC

- 명령어 집합 구조(ISA) : CPU가 이해할 수 있는 명령어들의 모음 -> CPU마다 ISA가 다를 수 있음

  명령어 병렬 처리 기법들을 도입하기 유리한 ISA

  1. CISC(Complex Instruction Set Computer) - 복잡한 명령어 집합을 활용하는 컴퓨터(CPU)

     -> 명령어의 형태와 크기가 다양한 '가변 길이 명령어' 활용 + 강력?

     ->적은 수의 명령어만으로도 프로그램을 동작시킬 수 있음

     명령어의 크기와 실행되기까지 시간 일정x , 명령어 하나에 여러 클럭 주기 필요, 자주쓰는 명령어만 사용

  2. RISC(Reduced Instruction Set Computer) - 축소 명령어 집합 컴퓨터

     -> 단순하고 적은 수의 '고정 길이 명령어' 활용 (짧고 규격화된 명령어) - 파이프 라이닝 유리

     -> 사용가능한 명령어 개수가 CISC보다 적어서 더 많은 명령으로 프로그램 작동
